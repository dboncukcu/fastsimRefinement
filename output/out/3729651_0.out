test2_log_tanh100_recJetpt
selected device is cuda
Output Path:  /eos/user/d/dboncukc/fastsim/test2_log_tanh100_recJetpt/20240312.root

### get training data

### build model
Sequential(
  (LogTransform): LogTransform()
  (Tanh200Transform): TanhTransform()
  (LogitTransform): LogitTransform()
  (OneHotEncode_RecJet_hadronFlavour_FastSim): OneHotEncode()
  (LinearWithSkipConnection_0): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=10, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LinearWithSkipConnection_1): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LinearWithSkipConnection_2): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LinearWithSkipConnection_3): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LinearWithSkipConnection_last): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=5, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LogitTransformBack): LogitTransformBack()
  (Tanh200TransformBack): TanhTransformBack()
  (LogTransformBack): LogTransformBack()
  (CastTo16Bit): CastTo16Bit()
)
8413189 trainable parameters

### start training

# epoch 1

evaluate benchmarks and starting points

benchmarks
mmdfixsigma_output_target, mmd_output_target, mmd_output_target_hadflav0, mmd_output_target_hadflav4, mmd_output_target_hadflav5, mmd_output_target_hadflavSum, mse_output_target, mse_input_output, huber_output_target, huber_input_output, deepjetsum_mean, deepjetsum_std
0.004634403623640537, 0.0029337170999497175, 0.004754608264192939, 0.016830821987241507, 0.008809748105704784, 0.00731833535246551, 1.1862613558769226, 0.0, 0.0582172516733408, 0.0, 1.000007450580597, 0.0011560013517737389

start points
mmdfixsigma_output_target, mmd_output_target, mmd_output_target_hadflav0, mmd_output_target_hadflav4, mmd_output_target_hadflav5, mmd_output_target_hadflavSum, mse_output_target, mse_input_output, huber_output_target, huber_input_output, deepjetsum_mean, deepjetsum_std
0.004604494199156761, 0.0029021684313192964, 0.004698658594861627, 0.016783230006694794, 0.008792793843895197, 0.007276145741343498, 1.1859856247901917, 4.403972525324207e-06, 0.05820421688258648, 2.2019862626621034e-06, 1.001578688621521, 0.0017179917776957154


training loop
batch 0
train loss 0.00800
batch 1
train loss 0.00655
[1 / 2] train loss: 0.0072752007

validation loop
batch 0
validation loss 0.00720
batch 1
validation loss 0.00698
[1 / 2] validation loss: 0.0072752007

# epoch 2

training loop
batch 0
train loss 0.00798
batch 1
train loss 0.00654
[2 / 2] train loss: 0.0072627207

validation loop
batch 0
validation loss 0.00719
batch 1
validation loss 0.00697
[2 / 2] validation loss: 0.0072627207

end points train
mmdfixsigma_output_target, mmd_output_target, mmd_output_target_hadflav0, mmd_output_target_hadflav4, mmd_output_target_hadflav5, mmd_output_target_hadflavSum, mse_output_target, mse_input_output, huber_output_target, huber_input_output, deepjetsum_mean, deepjetsum_std
0.0045946938917040825, 0.0028921968769282103, 0.004677745047956705, 0.01677241502329707, 0.008787298575043678, 0.007261360064148903, 1.1858909726142883, 5.98300402998575e-06, 0.05820037052035332, 2.991502014992875e-06, 1.0013936161994934, 0.001816550677176565

end points validation
mmdfixsigma_output_target, mmd_output_target, mmd_output_target_hadflav0, mmd_output_target_hadflav4, mmd_output_target_hadflav5, mmd_output_target_hadflavSum, mse_output_target, mse_input_output, huber_output_target, huber_input_output, deepjetsum_mean, deepjetsum_std
0.004622478503733873, 0.0029331673868000507, 0.005122033646330237, 0.01669701747596264, 0.007500829640775919, 0.007079864619299769, 1.2159188389778137, 6.220825298441923e-06, 0.05889282934367657, 3.1104126492209616e-06, 1.001518428325653, 0.0014135659439489245

just created /eos/user/d/dboncukc/fastsim/test2_log_tanh100_recJetpt/20240312.pt
just created /eos/user/d/dboncukc/fastsim/test2_log_tanh100_recJetpt/20240312.root
just created /eos/user/d/dboncukc/fastsim/test2_log_tanh100_recJetpt/20240312_train.csv
just created /eos/user/d/dboncukc/fastsim/test2_log_tanh100_recJetpt/20240312_validation.csv


..::The Story has been ended::..

