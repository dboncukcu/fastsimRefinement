epoch2_log_tanh100_recJetpt
selected device is cuda
Output Path:  /eos/user/d/dboncukc/fastsim/epoch2_log_tanh100_recJetpt/20240311.root

### get training data

### build model
Sequential(
  (LogTransform): LogTransform()
  (Tanh200Transform): TanhTransform()
  (LogitTransform): LogitTransform()
  (OneHotEncode_RecJet_hadronFlavour_FastSim): OneHotEncode()
  (LinearWithSkipConnection_0): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=10, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LinearWithSkipConnection_1): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LinearWithSkipConnection_2): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LinearWithSkipConnection_3): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LinearWithSkipConnection_last): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=5, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LogitTransformBack): LogitTransformBack()
  (Tanh200TransformBack): TanhTransformBack()
  (LogTransformBack): LogTransformBack()
  (CastTo16Bit): CastTo16Bit()
)
8413189 trainable parameters

### start training

# epoch 1

evaluate benchmarks and starting points

benchmarks
mmdfixsigma_output_target, mmd_output_target, mmd_output_target_hadflav0, mmd_output_target_hadflav4, mmd_output_target_hadflav5, mmd_output_target_hadflavSum, mse_output_target, mse_input_output, huber_output_target, huber_input_output, deepjetsum_mean, deepjetsum_std
0.00479541253298521, 0.003123412374407053, 0.004969157977029681, 0.019854698330163956, 0.007980952272191644, 0.007471261080354452, 1.1967421770095825, 0.0, 0.058766454458236694, 0.0, 0.9999939203262329, 0.0011318489559926093

start points
mmdfixsigma_output_target, mmd_output_target, mmd_output_target_hadflav0, mmd_output_target_hadflav4, mmd_output_target_hadflav5, mmd_output_target_hadflavSum, mse_output_target, mse_input_output, huber_output_target, huber_input_output, deepjetsum_mean, deepjetsum_std
0.004794811364263296, 0.0031225919956341386, 0.004968375666067004, 0.01985645294189453, 0.007978651905432343, 0.007470232201740146, 1.1966994404792786, 1.0963490240101237e-06, 0.058766208589076996, 5.481745120050618e-07, 1.002071738243103, 0.002017685677856207


training loop
batch 0
train loss 0.00744
batch 1
train loss 0.00750
[1 / 2] train loss: 0.0074700739

validation loop
batch 0
validation loss 0.00659
batch 1
validation loss 0.00750
[1 / 2] validation loss: 0.0074700739

# epoch 2

training loop
batch 0
train loss 0.00743
batch 1
train loss 0.00749
[2 / 2] train loss: 0.0074576556

validation loop
batch 0
validation loss 0.00658
batch 1
validation loss 0.00749
[2 / 2] validation loss: 0.0074576556

end points train
mmdfixsigma_output_target, mmd_output_target, mmd_output_target_hadflav0, mmd_output_target_hadflav4, mmd_output_target_hadflav5, mmd_output_target_hadflavSum, mse_output_target, mse_input_output, huber_output_target, huber_input_output, deepjetsum_mean, deepjetsum_std
0.004784933291375637, 0.0031123619992285967, 0.00494854967109859, 0.019842324778437614, 0.007973215775564313, 0.007455748505890369, 1.1965710520744324, 1.1326409889989009e-06, 0.058760542422533035, 5.663204944994504e-07, 1.001737356185913, 0.0018119390006177127

end points validation
mmdfixsigma_output_target, mmd_output_target, mmd_output_target_hadflav0, mmd_output_target_hadflav4, mmd_output_target_hadflav5, mmd_output_target_hadflavSum, mse_output_target, mse_input_output, huber_output_target, huber_input_output, deepjetsum_mean, deepjetsum_std
0.004456692840903997, 0.00277845561504364, 0.004306012415327132, 0.015810941345989704, 0.009030652698129416, 0.00703374738804996, 1.1782896518707275, 8.222294525239704e-07, 0.05789531208574772, 4.111147262619852e-07, 1.0013681054115295, 0.0014254039851948619

just created /eos/user/d/dboncukc/fastsim/epoch2_log_tanh100_recJetpt/20240311.pt
just created /eos/user/d/dboncukc/fastsim/epoch2_log_tanh100_recJetpt/20240311.root
just created /eos/user/d/dboncukc/fastsim/epoch2_log_tanh100_recJetpt/20240311_train.csv
just created /eos/user/d/dboncukc/fastsim/epoch2_log_tanh100_recJetpt/20240311_validation.csv


..::The Story has been ended::..

