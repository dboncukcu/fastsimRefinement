test_log1_recJetpt
selected device is cuda
Output Path:  /eos/user/d/dboncukc/fastsim/test_log1_recJetpt/20240311.root

### get training data

### build model
Sequential(
  (LogTransform): LogTransform()
  (Tanh200Transform): TanhTransform()
  (LogitTransform): LogitTransform()
  (OneHotEncode_RecJet_hadronFlavour_FastSim): OneHotEncode()
  (LinearWithSkipConnection_0): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=10, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LinearWithSkipConnection_1): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LinearWithSkipConnection_2): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LinearWithSkipConnection_3): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=1024, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LinearWithSkipConnection_last): LinearWithSkipConnection(
    (_linears): ModuleList(
      (0): Linear(in_features=1024, out_features=1024, bias=True)
      (1): Linear(in_features=1024, out_features=5, bias=True)
    )
    (_leakyrelus): ModuleList(
      (0): LeakyReLU(negative_slope=0.01)
      (1): LeakyReLU(negative_slope=0.01)
    )
    (_dropouts): ModuleList(
      (0): Dropout(p=0.2, inplace=False)
      (1): Dropout(p=0.2, inplace=False)
    )
  )
  (LogitTransformBack): LogitTransformBack()
  (Tanh200TransformBack): TanhTransformBack()
  (LogTransformBack): LogTransformBack()
  (CastTo16Bit): CastTo16Bit()
)
8413189 trainable parameters

### start training

# epoch 1

evaluate benchmarks and starting points

benchmarks
mmdfixsigma_output_target, mmd_output_target, mmd_output_target_hadflav0, mmd_output_target_hadflav4, mmd_output_target_hadflav5, mmd_output_target_hadflavSum, mse_output_target, mse_input_output, huber_output_target, huber_input_output, deepjetsum_mean, deepjetsum_std
0.00483873556368053, 0.003153554047457874, 0.0057335959281772375, 0.015725200530141592, 0.007088070968165994, 0.007192115066573024, 1.1831342577934265, 0.0, 0.05837332084774971, 0.0, 1.000014066696167, 0.0011390218860469759

start points
mmdfixsigma_output_target, mmd_output_target, mmd_output_target_hadflav0, mmd_output_target_hadflav4, mmd_output_target_hadflav5, mmd_output_target_hadflavSum, mse_output_target, mse_input_output, huber_output_target, huber_input_output, deepjetsum_mean, deepjetsum_std
0.004959956742823124, 0.0032739327289164066, 0.00595918926410377, 0.015912051312625408, 0.007205583155155182, 0.00737799471244216, 1.1835485100746155, 0.0007274642703123391, 0.058724600821733475, 0.00036373193142935634, 0.9999996423721313, 0.002068982576020062


training loop
batch 0
train loss 0.00691
batch 1
train loss 0.00784
[1 / 2] train loss: 0.0073736268

validation loop
batch 0
validation loss 0.00706
batch 1
validation loss 0.00837
[1 / 2] validation loss: 0.0073736268

# epoch 2

training loop
batch 0
train loss 0.00688
batch 1
train loss 0.00781
[2 / 2] train loss: 0.0073457367

validation loop
batch 0
validation loss 0.00703
batch 1
validation loss 0.00834
[2 / 2] validation loss: 0.0073457367

end points train
mmdfixsigma_output_target, mmd_output_target, mmd_output_target_hadflav0, mmd_output_target_hadflav4, mmd_output_target_hadflav5, mmd_output_target_hadflavSum, mse_output_target, mse_input_output, huber_output_target, huber_input_output, deepjetsum_mean, deepjetsum_std
0.004938520723953843, 0.0032522885594516993, 0.005911597982048988, 0.015894831623882055, 0.007192973513156176, 0.007345059188082814, 1.1834172010421753, 0.0006878424319438636, 0.0586995929479599, 0.0003439209394855425, 0.9998938143253326, 0.002132025081664324

end points validation
mmdfixsigma_output_target, mmd_output_target, mmd_output_target_hadflav0, mmd_output_target_hadflav4, mmd_output_target_hadflav5, mmd_output_target_hadflavSum, mse_output_target, mse_input_output, huber_output_target, huber_input_output, deepjetsum_mean, deepjetsum_std
0.004986809333786368, 0.003317454131320119, 0.005328502273187041, 0.015965440776199102, 0.009194051381200552, 0.007683959323912859, 1.254161775112152, 0.0006564707437064499, 0.0596146360039711, 0.0003282352408859879, 0.9997656941413879, 0.0018172888667322695

just created /eos/user/d/dboncukc/fastsim/test_log1_recJetpt/20240311.pt
just created /eos/user/d/dboncukc/fastsim/test_log1_recJetpt/20240311.root
just created /eos/user/d/dboncukc/fastsim/test_log1_recJetpt/20240311_train.csv
just created /eos/user/d/dboncukc/fastsim/test_log1_recJetpt/20240311_validation.csv


..::The Story has been ended::..

